<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 14 Code Once, Run Twice: Creating Your Own Functions | R Without Statistics</title>

    <meta name="author" content="David Keyes" />
  
   <meta name="description" content="Since R was invented in 1993, it has become a widely used programming language for statistical analysis. From academia to the tech world and beyond, R is used for a wide range of statistical analysis. R Without Statistics will show ways that R can be used beyond complex statistical analysis. Readers will learn about a range of uses for R, many of which they have likely never even considered." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 14 Code Once, Run Twice: Creating Your Own Functions | R Without Statistics" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://book.rwithoutstatistics.com" />
  <meta property="og:image" content="https://book.rwithoutstatistics.com/mock-cover.png" />
  <meta property="og:description" content="Since R was invented in 1993, it has become a widely used programming language for statistical analysis. From academia to the tech world and beyond, R is used for a wide range of statistical analysis. R Without Statistics will show ways that R can be used beyond complex statistical analysis. Readers will learn about a range of uses for R, many of which they have likely never even considered." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Code Once, Run Twice: Creating Your Own Functions | R Without Statistics" />
  
  <meta name="twitter:description" content="Since R was invented in 1993, it has become a widely used programming language for statistical analysis. From academia to the tech world and beyond, R is used for a wide range of statistical analysis. R Without Statistics will show ways that R can be used beyond complex statistical analysis. Readers will learn about a range of uses for R, many of which they have likely never even considered." />
  <meta name="twitter:image" content="https://book.rwithoutstatistics.com/mock-cover.png" />
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.4.2/transition.js"></script>
    <script src="libs/bs3compat-0.4.2/tabs.js"></script>
    <script src="libs/bs3compat-0.4.2/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R Without Statistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="code-once-run-twice-creating-your-own-functions" class="section level1" number="14">
<h1><span class="header-section-number">Chapter 14</span> Code Once, Run Twice: Creating Your Own Functions</h1>
<p>Bruno Rodrigues, head of the Department of Statistics and Data Strategy at the Ministry of Higher Education and Research in Luxembourg, is an avid R user. The same, however, cannot be said for all of his teammates. So Rodrigues needs a way to be able to easily share data with his non-R-user colleagues. Being the avid R user that he is, he wrote some R code to help him with this task. Specifically, he wrote a function called <code>show_in_excel()</code> (which we’ll explore in depth below) that would take a data frame from R, save it as a CSV file, and open the CSV file in Excel. From then on, whenever he needed to have his data in a CSV to share with colleagues, he could run his function and share away.</p>
<p>Let’s look at the <code>show_in_excel()</code> function that Bruno Rodrigues created (I’ll be using a slightly simplified version of it here). We begin by loading the <code>tidyverse</code> and <code>fs</code> packages. We’ll use the <code>tidyverse</code>, which you’ve seen throughout this book, to create a file name and save our CSV. The <code>fs</code> package will enable us to open the CSV file in Excel (or whichever program your computer uses to open CSV files by default).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)</span></code></pre></div>
<p>Functions have three pieces:</p>
<ol style="list-style-type: decimal">
<li>Name</li>
<li>Body</li>
<li>Arguments</li>
</ol>
<p>Before we look at the <code>show_in_excel()</code> function, let’s look at a slightly altered version to help us understand how functions work. This function, called <code>show_in_excel_penguins()</code> opens the data on penguins that we saw in <a href="rmarkdown-chapter.html#rmarkdown-chapter">8</a> in Excel. We begin by importing the data with the <code>read_csv()</code> function before creating the <code>show_in_excel_penguins()</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://data.rwithoutstatistics.com/penguins-2007.csv&quot;</span>)</span>
<span id="cb2-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-3" aria-hidden="true" tabindex="-1"></a>show_in_excel_penguins <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb2-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-5" aria-hidden="true" tabindex="-1"></a>  csv_file <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">&quot;{tempfile()}.csv&quot;</span>)</span>
<span id="cb2-6"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-7"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="at">x =</span> penguins,</span>
<span id="cb2-8"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">file =</span> csv_file,</span>
<span id="cb2-9"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">na =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb2-10"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-11"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_show</span>(<span class="at">path =</span> csv_file)</span>
<span id="cb2-12"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="code-once-run-twice-creating-your-own-functions.html#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To understand how our function works, take a look at the first line. In this line, we begin by giving our function a <strong>name</strong>: <code>show_in_excel_penguins</code>. We next use the assignment operator (<code>&lt;-</code>) and <code>function()</code> to specify that <code>show_in_excel_penguins</code> is not a variable name, but a function name. There’s an open curly bracket (<code>{</code>) at the end of the line, which indicates the start of the function <strong>body</strong>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb3-1" aria-hidden="true" tabindex="-1"></a>show_in_excel_penguins <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span></code></pre></div>
<p>The meat of the function can be found in its body. This is all of the code in between the open and closed curly brackets.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb4-1" aria-hidden="true" tabindex="-1"></a>show_in_excel_penguins <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb4-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function body goes here</span></span>
<span id="cb4-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In the case of the <code>show_in_excel_penguins()</code> function we’ve created, the body does three things:</p>
<ol style="list-style-type: decimal">
<li><p>Creates a location for a CSV file to be saved using the <code>str_glue()</code> function combined with the <code>tempfile()</code> function. This creates a file at a temporary location with the .csv extension and saves it as <code>csv_file</code>.</p></li>
<li><p>Writes <code>penguins</code> (the <code>x</code> argument in <code>write_csv()</code> refers to the data frame to be saved) to the location set in <code>csv_file</code>. We also make all NA values show up as blanks (by default, they will show up as the text “NA”).</p></li>
<li><p>Uses the <code>file_show</code> function from the <code>fs</code> package to open the temporarily created CSV file in Excel.</p></li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb5-1" aria-hidden="true" tabindex="-1"></a>csv_file <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">&quot;{tempfile()}.csv&quot;</span>)</span>
<span id="cb5-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(<span class="at">x =</span> penguins,</span>
<span id="cb5-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb5-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">file =</span> csv_file,</span>
<span id="cb5-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb5-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">na =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb5-6"><a href="code-once-run-twice-creating-your-own-functions.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-7"><a href="code-once-run-twice-creating-your-own-functions.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">file_show</span>(<span class="at">path =</span> csv_file)</span></code></pre></div>
<p>If you wanted to use the <code>show_in_excel_penguins()</code> function, you would run the lines where you define the function. From there on out, any time you run the code <code>show_in_excel_penguins()</code>, R will open up the <code>penguins</code> data frame in Excel.</p>
<p>Now, you’re probably thinking: that doesn’t seem like the most useful function. Why would I want to keep opening up the <code>penguins</code> data frame? You wouldn’t, of course. To make your function more useful, we need to add arguments. Below is the actual code that Bruno Rodrigues used. Everything looks the same as our <code>show_in_excel_penguins()</code> function with one exception: the first line now says <code>function(data)</code>. Items listed within the parentheses of our function definition are <strong>arguments</strong>. If you look further down, you’ll see one other change. Within <code>write_csv()</code>, instead of <code>x = penguins</code>, we now have <code>x = data</code>. This allows us to use the function with any data, not just <code>penguins</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-1" aria-hidden="true" tabindex="-1"></a>show_in_excel <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb6-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  csv_file <span class="ot">&lt;-</span> <span class="fu">str_glue</span>(<span class="st">&quot;{tempfile()}.csv&quot;</span>)</span>
<span id="cb6-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="at">x =</span> data,</span>
<span id="cb6-6"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">file =</span> csv_file,</span>
<span id="cb6-7"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">na =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb6-8"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-9"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file_show</span>(<span class="at">path =</span> csv_file)</span>
<span id="cb6-10"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-11"><a href="code-once-run-twice-creating-your-own-functions.html#cb6-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>To use this function, you tell <code>show_in_excel()</code> what data to use and the function will open it in Excel. You can tell it to open the <code>penguins</code> data frame as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_in_excel</span>(<span class="at">data =</span> penguins)</span></code></pre></div>
<p>But, having created the function with the <code>data</code> argument, we can run it with any data we want to. This code, for example, will import COVID case data we saw in Chapter <a href="websites-chapter.html#websites-chapter">11</a> and open it in Excel.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb8-1" aria-hidden="true" tabindex="-1"></a>covid_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://data.rwithoutstatistics.com/us-states-covid-rolling-average.csv&quot;</span>)</span>
<span id="cb8-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">show_in_excel</span>(<span class="at">data =</span> covid_data)</span></code></pre></div>
<p>You can also use this function at the end of a pipeline. This code filters the <code>covid_data</code> data frame to only include data from California before opening it in Excel.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb9-1" aria-hidden="true" tabindex="-1"></a>covid_data <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">&quot;California&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_in_excel</span>()</span></code></pre></div>
<p>Bruno Rodrigues could have copied the code within the <code>show_in_excel()</code> function and re-run it every time he wanted to view his data in Excel. But, by creating a function, he creates the code once and can run it as many times as necessary.</p>
<div id="creating-a-ggplot-theme-function" class="section level2 unnumbered">
<h2>Creating a ggplot Theme Function</h2>
<p>In the <code>show_in_excel()</code> function, nothing is changed within R; it simply allows us to view data in Excel. A more typical use case is to create a function that you use while working in R to do something to your data or, in the case below, plots. A common example is creating your own ggplot theme.</p>
<p>We’ve seen ggplot themes in Chapters <a href="data-viz-chapter.html#data-viz-chapter">4</a> and <a href="maps-chapter.html#maps-chapter">6</a>, but these uses were one-offs. Chapter <a href="custom-theme-chapter.html#custom-theme-chapter">5</a> showed how the BBC made a custom theme to be used across projects. This multi-project use case shows the value of creating a function. Rather than copying your ggplot theme code from one project to the next, you can create it once and use it across all projects.</p>
<p>Below, we can see a custom theme that I’ve created for myself. Called <code>theme_dk()</code>, this function sets the defaults that I like to use in my plots, including removing axis ticks, adjusting the font size of axis titles as well as the plot title and subtitle, and putting the legend above the plot and increasing its font size.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-1" aria-hidden="true" tabindex="-1"></a>theme_dk <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">show_grid_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">show_axis_titles =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb10-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  custom_theme <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-6"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-7"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb10-8"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb10-9"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb10-10"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb10-11"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb10-12"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb10-13"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb10-14"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb10-15"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-15" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb10-16"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-16" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">8</span>)),</span>
<span id="cb10-17"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb10-18"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb10-19"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb10-20"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb10-21"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-22"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (show_grid_lines <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb10-23"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-24"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-24" aria-hidden="true" tabindex="-1"></a>    custom_theme <span class="ot">&lt;-</span> custom_theme <span class="sc">+</span></span>
<span id="cb10-25"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>())</span>
<span id="cb10-26"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-27"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-28"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-29"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (show_axis_titles <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb10-30"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-31"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-31" aria-hidden="true" tabindex="-1"></a>    custom_theme <span class="ot">&lt;-</span> custom_theme <span class="sc">+</span></span>
<span id="cb10-32"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-33"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-34"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb10-35"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-36"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-37"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-38"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-38" aria-hidden="true" tabindex="-1"></a>  custom_theme</span>
<span id="cb10-39"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-40"><a href="code-once-run-twice-creating-your-own-functions.html#cb10-40" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>I can then apply my theme as I would any other ggplot theme.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm,</span>
<span id="cb11-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> bill_depth_mm,</span>
<span id="cb11-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> island)) <span class="sc">+</span></span>
<span id="cb11-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-6"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A histogram of bill length and bill depth&quot;</span>,</span>
<span id="cb11-7"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Data from palmerpenguins package&quot;</span>,</span>
<span id="cb11-8"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Bill Length&quot;</span>,</span>
<span id="cb11-9"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Bill Depth&quot;</span>,</span>
<span id="cb11-10"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="code-once-run-twice-creating-your-own-functions.html#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dk</span>()</span></code></pre></div>
<p>In Figure <a href="code-once-run-twice-creating-your-own-functions.html#fig:theme-dk-histogram">14.1</a> below, we can see what a histogram made with <code>theme_dk()</code> looks like using the same <code>penguins</code> data.</p>
<div class="figure"><span style="display:block;" id="fig:theme-dk-histogram"></span>
<img src="packages_files/figure-html/theme-dk-histogram-1.png" alt="A histogram made with my custom theme" width="100%" />
<p class="caption">
Figure 14.1: A histogram made with my custom theme
</p>
</div>
<p>Let’s now discuss how the custom ggplot theme function works. The first three lines define our function and provide two arguments: <code>show_grid_lines</code> and <code>show_axis_titles</code>. Whereas the <code>data</code> argument in <code>show_in_excel()</code> required us to give the function data, the arguments in <code>theme_dk()</code> have defaults built in. The lines <code>show_grid_lines = TRUE</code> and <code>show_axis_lines = TRUE</code> mean that grid lines and axis titles will be visible on our plot by default.</p>
<p>The first piece of the code in <code>theme_dk()</code> starts with <code>theme_minimal()</code> (for more on the specifics of making a custom theme refer to how the <code>bbc_style()</code> function was created in Chapter <a href="custom-theme-chapter.html#custom-theme-chapter">5</a>). The changes that are then made with the <code>theme()</code> function are saved as an object called <code>custom_theme</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-1" aria-hidden="true" tabindex="-1"></a>custom_theme <span class="ot">&lt;-</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb12-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb12-6"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb12-7"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)),</span>
<span id="cb12-8"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb12-9"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb12-10"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb12-11"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb12-12"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb12-13"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">8</span>)),</span>
<span id="cb12-14"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb12-15"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-15" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb12-16"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb12-17"><a href="code-once-run-twice-creating-your-own-functions.html#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p>One difference between <code>theme_dk()</code> and <code>bbc_style()</code> is that <code>theme_dk()</code> is a bit more flexibile. I do this using two <code>if</code> statements. While I defined the default plot to show grid lines and axis titles, if the user sets the <code>show_grid_lines</code> and <code>show_axis_titles</code> arguments to FALSE, those elements will be removed. The <code>if</code> statements test whether <code>show_grid_lines</code> and <code>show_axis_titles</code> are set to TRUE. If so, it changes the <code>custom_theme</code> object. At the end of the function, we do what’s called returning an object. In this case, we return the <code>custom_theme</code> object, meaning that <code>custom_theme</code>, with or without our changes to grid lines and axis titles is returned, making it available to use in our plot.</p>
<p>To show an example of when we might want to remove grid lines and axis titles, I’ll create a simple bar chart of the number of penguins on each island.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb13-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(island) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> island,</span>
<span id="cb13-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb13-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb13-6"><a href="code-once-run-twice-creating-your-own-functions.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of penguins on each island&quot;</span>,</span>
<span id="cb13-7"><a href="code-once-run-twice-creating-your-own-functions.html#cb13-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Data from palmerpenguins package&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="code-once-run-twice-creating-your-own-functions.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dk</span>(<span class="at">show_grid_lines =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-9"><a href="code-once-run-twice-creating-your-own-functions.html#cb13-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">show_axis_titles =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>When I use <code>theme_dk()</code> here, I set <code>show_grid_lines</code> and <code>show_axis_titles</code> to FALSE, removing those elements from our chart. We can see the result in Figure <a href="code-once-run-twice-creating-your-own-functions.html#fig:theme-dk-bar-chart">14.2</a>.</p>
<div class="figure"><span style="display:block;" id="fig:theme-dk-bar-chart"></span>
<img src="packages_files/figure-html/theme-dk-bar-chart-1.png" alt="A bar chart using my custom theme" width="100%" />
<p class="caption">
Figure 14.2: A bar chart using my custom theme
</p>
</div>
<p>Creating a function with default arguments allows us to set the options that we are most likely to want, while also giving us flexibility to change the arguments each time we use the function.</p>
</div>
<div id="how-to-create-a-package" class="section level2 unnumbered">
<h2>How to Create a Package</h2>
<p>Burno Rodrigues made his <code>show_in_excel()</code> function to avoid having to copy his code over and over. Hadley Wickham, developer of the <code>tidyverse</code> set of packages, recommends creating a function once you’ve copied code three times. There’s another step on the road to coding efficiency: bundle your functions into a package. How do you know whether functions you write should be put into a package? The answer is simple: if you plan to use the function in multiple projects, put it into a package. You may find yourself copying functions from one project to another. Or perhaps you have a set of functions you’ve saved in a <code>functions.R</code> file that you copy into each new project you work. Both are good indications that you’re ready for a project (Travis Gerke said that a <code>functions.R</code> file “screams ‘make a package’”). The <code>theme_dk()</code> function I made is an example of this. I I could use it in any project where I make data visualization so let’s put it in a package.</p>
<div id="starting-the-package" class="section level3 unnumbered">
<h3>Starting the Package</h3>
<p>To create a package in RStudio, go to the File menu, then select New Project. From there, select New Directory. You’ll be given a list of options, one of which is R Package. Select that and you’ll then need to give your package a name (I’m going to call mine <code>dk</code>) and decide where you want it to live on your computer. You can leave everything else as is.</p>
<div class="figure"><span style="display:block;" id="fig:rstudio-create-package"></span>
<img src="assets/create-r-package.png" alt="The RStudio menu for creating your package" width="100%" />
<p class="caption">
Figure 14.3: The RStudio menu for creating your package
</p>
</div>
<p>RStudio will now create and open my package. There are a few files in the package already, including <code>hello.R</code>, which has a prebuilt function called <code>hello()</code> that, when run, prints the text “Hello, world!” in the console. Let’s get rid of it and a few other default files so we’re starting with a clean slate. I’ll delete <code>hello.R</code>, <code>NAMESPACE</code>, and the <code>hello.Rd</code> file in the <code>man</code> directory.</p>
<p>Much of the work we’ll do working with our package relies on the <code>usethis</code> and <code>devtools</code> packages. Install those using <code>install.packages()</code> if you don’t already have them installed. Once you’ve done that, you’re ready to add a function to the package. To do so, run the <code>use_r()</code> function from the <code>usethis</code> package. I typically run functions from <code>usethis</code> and <code>devtools</code> in the console because I only need to run them once. I also tend to run them with the syntax <code>package::function()</code>, which makes it possible to use a function without loading the package (it’s also how we have to refer to functions in our package, as we’ll see below). Here’s how I would run the <code>use_r()</code> function:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb14-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_r</span>(<span class="st">&quot;theme&quot;</span>)</span></code></pre></div>
<p>This function will create a file called <code>theme.R</code> in the <code>R</code> directory with the name you give it as an argument (all functions in a package go in files in the <code>R</code> folder). I can open up the file and add code to it. I’ll begin by copying the <code>theme_dk()</code> function I created. We know <code>theme_dk()</code> works, but we need to change it in a few ways to make it work in a package. The easiest way to figure out what changes we need to make is to use built-in tools to check that our package is built correctly.</p>
</div>
<div id="checking-our-package" class="section level3 unnumbered">
<h3>Checking our Package</h3>
<p>To test that our package works, run the function <code>devtools::check()</code>. This runs what is known as <code>R CMD check</code>, which makes sure that others can install your package on their system. Running <code>R CMD check</code> on the <code>dk</code> package gives us a long message. The last part is the most important:</p>
<pre><code>── R CMD check results ─────────────── dk 0.1.0 ────
Duration: 9.5s

❯ checking DESCRIPTION meta-information ... WARNING
Non-standard license specification:
What license is it under?
Standardizable: FALSE

❯ checking for missing documentation entries ... WARNING
Undocumented code objects:
‘theme_dk’
All user-level objects in a package should have documentation entries.
See chapter ‘Writing R documentation files’ in the ‘Writing R
Extensions’ manual.

❯ checking R code for possible problems ... NOTE
theme_dk: no visible global function definition for ‘theme_minimal’
theme_dk: no visible global function definition for ‘theme’
theme_dk: no visible global function definition for ‘element_blank’
theme_dk: no visible global function definition for ‘element_text’
theme_dk: no visible global function definition for ‘margin’
Undefined global functions or variables:
element_blank element_text margin theme theme_minimal

0 errors ✔ | 2 warnings ✖ | 1 note ✖</code></pre>
<p>Let’s review the output from bottom to top. The line “0 errors ✔ | 2 warnings ✖ | 1 note ✖” gives us the three levels of issues with our package. Errors are the most severe (meaning others won’t be able to install your package), followed by warnings and notes (both of which may cause problems for others). It’s best practice to eliminate all errors, warnings, and notes. Let’s start with the note, which shows up in this section:</p>
<pre><code>❯ checking R code for possible problems ... NOTE
theme_dk: no visible global function definition for ‘theme_minimal’
theme_dk: no visible global function definition for ‘theme’
theme_dk: no visible global function definition for ‘element_blank’
theme_dk: no visible global function definition for ‘element_text’
theme_dk: no visible global function definition for ‘margin’
Undefined global functions or variables:
element_blank element_text margin theme theme_minimal</code></pre>
<p>To understand what <code>R CMD check</code> is saying, we need to explain a bit about how packages work.</p>
</div>
<div id="adding-dependency-packages" class="section level3 unnumbered">
<h3>Adding Dependency Packages</h3>
<p>When you install a package using the <code>install.packages()</code> function, it often takes a while. That’s because, while you are telling R to install one package, that single package likely uses functions from other packages. In order to have access to these functions, R will install these packages (known as dependencies) for you. It would be a pain if, every time you installed package, you had to manually install a whole set of dependencies. But in order to make sure that the appropriate packages are installed for any users of the <code>dk</code> package, we have to make a few changes.</p>
<p>When we run <code>R CMD check</code>, we are told that we have several “Undefined global functions or variables” and “no visible global function definition” for various functions. This is because we are attempting to use functions from the <code>ggplot2</code> package, but we haven’t specified that these functions are from <code>ggplot2</code>. I can use this code because I have <code>ggplot2</code> installed, but we can’t assume that others will have <code>ggplot2</code> installed. In order to ensure the code will work, we need to install <code>ggplot2</code> for users when they install the <code>dk</code> package. To do this, we run the <code>use_package()</code> function from the <code>usethis</code> package as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb17-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_package</span>(<span class="at">package =</span> <span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>After I run the <code>use_package()</code> code in the console, I get the following message:</p>
<pre><code>✔ Setting active project to &#39;/Users/davidkeyes/Documents/Work/R Without Statistics/dk&#39;
✔ Adding &#39;ggplot2&#39; to Imports field in DESCRIPTION
• Refer to functions with `ggplot2::fun()`</code></pre>
<p>The first line tells me that it is working in the <code>dk</code> project. The second line tells me that the <code>DESCRIPTION</code> file has been edited. This file provides meta information about the package we’re developing. If we open up the <code>DESCRIPTION</code> file (it’s in the root directory of our project), we see the following:</p>
<pre><code>Package: dk
Type: Package
Title: What the Package Does (Title Case)
Version: 0.1.0
Author: Who wrote it
Maintainer: The package maintainer &lt;yourself@somewhere.net&gt;
Description: More about what it does (maybe more than one line)
Use four spaces when indenting paragraphs within the Description.
License: What license is it under?
Encoding: UTF-8
LazyData: true
Imports:
ggplot2</code></pre>
<p>Way down at the bottom, look for the line that says “Imports:” followed by “ggplot2” on the next line. This indicates that, when a user installs the <code>dk</code> package, the <code>ggplot2</code> package will also be installed for them. It’s important to note that, while I use the <code>tidyverse</code> package (this meta package contains multiple packages, of which <code>ggplot2</code> is just one) when working on my own computer, when making your own package you want to have it install the individual packages needed to make it run.</p>
</div>
<div id="referring-to-functions-correctly" class="section level3 unnumbered">
<h3>Referring to Functions Correctly</h3>
<p>We’ll return to the DESCRIPTION file in a bit, but for now, let’s take a look at this line: “Refer to functions with <code>ggplot2::fun()</code>”. It is telling us that, in order to use functions from other packages in the <code>dk</code> package, we need to refer to them in a unique way. By specifying both the package name and the function name, you ensure that the correct function is used at all times. It is rare, but there are functions with identical names across multiple packages. Using this syntax avoids any ambiguity. Remember when we ran <code>R CMD check</code> and got this?</p>
<pre><code>Undefined global functions or variables:
element_blank element_text margin theme theme_minimal</code></pre>
<p>This is because we were using functions without saying what package they come from. All of the functions listed here come from the <code>ggplot2</code> package so I can add <code>ggplot2::</code> before them as follows:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-1" aria-hidden="true" tabindex="-1"></a>theme_dk <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">show_grid_lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">show_axis_titles =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb21-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  custom_theme <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-5" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb21-6"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">axis.ticks =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb21-7"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">axis.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb21-8"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-8" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb21-9"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">axis.title.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(</span>
<span id="cb21-10"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)</span>
<span id="cb21-11"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-11" aria-hidden="true" tabindex="-1"></a>                   ),</span>
<span id="cb21-12"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">axis.title.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(</span>
<span id="cb21-13"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">r =</span> <span class="dv">10</span>)</span>
<span id="cb21-14"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-14" aria-hidden="true" tabindex="-1"></a>                   ),</span>
<span id="cb21-15"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">axis.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb21-16"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-16" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb21-17"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb21-18"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot.title =</span> </span>
<span id="cb21-19"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-19" aria-hidden="true" tabindex="-1"></a>                     ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>,</span>
<span id="cb21-20"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-20" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb21-21"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-21" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">8</span>)</span>
<span id="cb21-22"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-22" aria-hidden="true" tabindex="-1"></a>                     ),</span>
<span id="cb21-23"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">plot.subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>,</span>
<span id="cb21-24"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-24" aria-hidden="true" tabindex="-1"></a>                                                         <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>),</span>
<span id="cb21-25"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb21-26"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb21-27"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-28"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (show_grid_lines <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb21-29"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-30"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-30" aria-hidden="true" tabindex="-1"></a>    custom_theme <span class="ot">&lt;-</span> custom_theme <span class="sc">+</span></span>
<span id="cb21-31"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-31" aria-hidden="true" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">panel.grid.major =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb21-32"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-33"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-34"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-35"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (show_axis_titles <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb21-36"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-37"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-37" aria-hidden="true" tabindex="-1"></a>    custom_theme <span class="ot">&lt;-</span> custom_theme <span class="sc">+</span></span>
<span id="cb21-38"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-38" aria-hidden="true" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">axis.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb21-39"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-39" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.title.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb21-40"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">axis.title.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>())</span>
<span id="cb21-41"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-42"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-43"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-44"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-44" aria-hidden="true" tabindex="-1"></a>  custom_theme</span>
<span id="cb21-45"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-46"><a href="code-once-run-twice-creating-your-own-functions.html#cb21-46" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now that I’ve specified that the various functions I’m using come from <code>ggplot2</code>, I can run the <code>devtools::check()</code> function again. When I do so, I now see that the notes have gone away.</p>
<pre><code>❯ checking DESCRIPTION meta-information ... WARNING
Non-standard license specification:
What license is it under?
Standardizable: FALSE

❯ checking for missing documentation entries ... WARNING
Undocumented code objects:
‘theme_dk’
All user-level objects in a package should have documentation entries.
See chapter ‘Writing R documentation files’ in the ‘Writing R
Extensions’ manual.

0 errors ✔ | 2 warnings ✖ | 0 notes ✔</code></pre>
<p>However, I can see that there are still two warnings that I need to deal with. Let’s do that next.</p>
</div>
<div id="adding-documentation" class="section level3 unnumbered">
<h3>Adding Documentation</h3>
<p>Let’s look now at the “checking for missing documentation entries” warning. This warning is telling us that we need to add documentation of our <code>theme_dk()</code> function. One of the benefits of creating a package is that you can add documentation to help others use your code. In the same way that users can type <code>?theme_mimimal()</code> and see documentation about that function, we want them to also be able to type <code>?theme_dk()</code> and learn how it works.</p>
<p>To create documentation for <code>theme_dk()</code>, we’ll use what’s known as Roxygen, which is a way to create documentation of functions in R packages using a package called <code>roxygen2</code>. To get started, place your cursor anywhere in the function. Then, go to the Code menu and select Insert Roxygen Skeleton, as seen in Figure <a href="code-once-run-twice-creating-your-own-functions.html#fig:insert-roxygen-skeleton">14.4</a> below.</p>
<div class="figure"><span style="display:block;" id="fig:insert-roxygen-skeleton"></span>
<img src="assets/insert-roxygen-skeleton.png" alt="The menu item to insert Roxygen skeleton" width="100%" />
<p class="caption">
Figure 14.4: The menu item to insert Roxygen skeleton
</p>
</div>
<p>Doing this will add some text above the <code>theme_dk()</code> function that looks like this:</p>
<pre><code>#&#39; Title
#&#39;
#&#39; @param show_grid_lines 
#&#39; @param show_axis_titles 
#&#39;
#&#39; @return
#&#39; @export
#&#39;
#&#39; @examples</code></pre>
<p>This text is the skeleton of what is needed to create documentation of the <code>theme_dk()</code> function. Each line starts with the special characters <code>#'</code>, which indicate we’re working with Roxygen. We can now go in and edit the Roxygen text to create our documentation. Starting at the top, I’ll replace Title with a sentence that describes my function.</p>
<pre><code>#&#39; David Keyes&#39;s custom ggplot theme </code></pre>
<p>Next, you can see lines with the text <code>@param</code>. Roxygen automatically looks at the arguments in our function and creates a line for each one. On each line, we want to describe what the argument does. I can do this as follows.</p>
<pre><code>#&#39; @param show_grid_lines Should grid lines be shown (TRUE/FALSE)
#&#39; @param show_axis_titles Should axis titles be shown (TRUE/FALSE) </code></pre>
<p>Going down the Roxygen skeleton, we next see <code>@return</code>. This is where we tell the user what the <code>dk_theme()</code> function returns. In our case, it is a complete <code>ggplot2</code> theme, which I document as follows:</p>
<pre><code>#&#39; @return A complete ggplot2 theme</code></pre>
<p>Below <code>@return</code> is <code>@export</code>. We don’t need to change anything here. Most functions in a package are known as “exported functions,” meaning they are available to users of the package (in contrast, internal functions, which are only used by the package developers, do not have <code>@export</code> in the Roxygen skeleton).</p>
<p>The last section is <code>@examples</code>. This is where you can give examples of code that users can run to learn how the function works. Doing this introduces some complexity and isn’t required so I’m going to skip it. If you do want to learn more, Chapter 17 of the second edition of Hadley Wickham and Jenny Bryan’s book <em>R Packages</em> is a great place to learn about adding examples.</p>
<p>Now that we’ve added the documentation with Roxygen, there’s one more step: running <code>devtools::document()</code>. This will do two things:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Create a <code>theme_dk.Rd</code> file in the <code>man</code> directory</strong>. This file is the documentation of our <code>theme_dk()</code> function in the very specific format that R packages require You’re welcome to look at it, but you can’t change it since it is read only.</p></li>
<li><p><strong>Create a <code>NAMESPACE</code> file</strong>. This file lists the functions that your package makes available to users. My NAMESPACE file now looks like this:</p></li>
</ol>
<pre><code># Generated by roxygen2: do not edit by hand

export(theme_dk)</code></pre>
<p>The <code>theme_dk()</code> function is now almost ready for users.</p>
</div>
<div id="editing-the-description-file" class="section level3 unnumbered">
<h3>Editing the <code>DESCRIPTION</code> File</h3>
<p>We can run <code>devtools::check()</code> again to see if we have fixed the issues that led to the warnings. Doing so shows that the warning about missing documentation is no longer there. However, we do still have one warning.</p>
<pre><code>❯ checking DESCRIPTION meta-information ... WARNING
Non-standard license specification:
What license is it under?
Standardizable: FALSE

0 errors ✔ | 1 warning ✖ | 0 notes ✔</code></pre>
<p>This warning is telling us that we haven’t given our package a license. For packages made publicly available, choosing a license is important (for information on how to choose the right one for your package, see <a href="https://choosealicense.com/" class="uri">https://choosealicense.com/</a>). It’s less important since we’re developing a package for our personal use, but we can still select one. I’ll use the MIT license (it allows people to do essentially whatever they want with the code) by running <code>usethis::use_mit_license()</code> (the <code>usethis</code> package has similar functions for other common licenses). Doing so returns the following:</p>
<pre><code>✔ Setting active project to &#39;/Users/davidkeyes/Documents/Work/R Without Statistics/dk&#39;
✔ Setting License field in DESCRIPTION to &#39;MIT + file LICENSE&#39;
✔ Writing &#39;LICENSE&#39;
✔ Writing &#39;LICENSE.md&#39;
✔ Adding &#39;^LICENSE\\.md$&#39; to &#39;.Rbuildignore&#39;</code></pre>
<p>The <code>use_mit_license()</code> function handles a lot of the tedious parts of adding a license to our package. Most importantly for us, it specifies the license in the <code>DESCRIPTION</code> file. If I open up that file, I can see confirmation that I’ve added the MIT license.</p>
<pre><code>Package: dk
Type: Package
Title: What the Package Does (Title Case)
Version: 0.1.0
Author: Who wrote it
Maintainer: The package maintainer &lt;yourself@somewhere.net&gt;
Description: More about what it does (maybe more than one line)
Use four spaces when indenting paragraphs within the Description.
License: MIT + file LICENSE
Encoding: UTF-8
LazyData: true
Imports:
ggplot2
RoxygenNote: 7.2.3</code></pre>
<p>In addition to the license, the <code>DESCRIPTION</code> file contains meta data about the package. We can make a few changes to change the Title, add an Author and Maintainer, and add a Description. My final <code>DESCRIPTION</code> file might look something like this:</p>
<pre><code>Package: dk
Type: Package
Title: David Keyes&#39;s Personal Package
Version: 0.1.0
Author: David Keyes
Maintainer: David Keyes &lt;david@rfortherestofus.com&gt;
Description: A package with functions that David Keyes may find 
useful.
License: MIT + file LICENSE
Encoding: UTF-8
LazyData: true
Imports:
ggplot2
RoxygenNote: 7.2.3</code></pre>
<p>Having made these changes, let’s run <code>devtools::check()</code> one more time to make sure everything is in order. When I do so, I get exactly what I hope to see:</p>
<pre><code>0 errors ✔ | 0 warnings ✔ | 0 notes ✔</code></pre>
<p>We’ve not got a package with one working function in it. If you wanted to add additional functions, you would follow the same exact procedure:</p>
<ol style="list-style-type: decimal">
<li>Create a new <code>.R</code> file with <code>usethis::use_r()</code> (you can also combine multiple functions in a single <code>.R</code> file).</li>
<li>Developer your function using the <code>package::function()</code> syntax to refer to functions from other packages.</li>
<li>Add any dependency packages with <code>use_package()</code>.</li>
<li>Add documentation of your function.</li>
<li>Run <code>devtools::check()</code> to make sure you did everything correctly.</li>
</ol>
<p>Your package can contain a single function, like <code>dk</code>, or as many functions as you want.</p>
</div>
<div id="installing-the-package" class="section level3 unnumbered">
<h3>Installing the Package</h3>
<p>Having developed our package, we’re now ready to install and use it. When you’re developing your own package, installing it for your own use is relatively straightforward. Simply run <code>devtools::install()</code> and the package will be ready for you to use in any project.</p>
<p>Of course, if you’re developing a package, you’re likely doing it not just for yourself, but for others as well. The most common way to make your package available to others is with the code-sharing website GitHub. The details of how to put your code on GitHub are beyond what we can cover here, but the book <em>Happy Git and GitHub for the useR</em> by Jenny Bryan is a great place to get started. I’ve pushed the <code>dk</code> package to GitHub and you can find it at <a href="https://github.com/dgkeyes/dk" class="uri">https://github.com/dgkeyes/dk</a>. If you or anyone else wants to install it, simply run the code <code>remotes::install_github("dgkeyes/dk")</code> (make sure you have the <code>remotes</code> package installed first). Once you or others install the <code>dk</code> package, anyone can just add the line <code>library(dk)</code> in any R code then use the <code>theme_dk()</code> function. We can recreate the penguin bill length and depth histogram from Chapter <a href="#functions-chapter"><strong>??</strong></a> with the following code.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dk)</span>
<span id="cb33-2"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-3"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb33-4"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-5" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb33-6"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm,</span>
<span id="cb33-7"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> bill_depth_mm,</span>
<span id="cb33-8"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> island)) <span class="sc">+</span></span>
<span id="cb33-9"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-10"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;A histogram of bill length and depth&quot;</span>,</span>
<span id="cb33-11"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Data from palmerpenguins package&quot;</span>,</span>
<span id="cb33-12"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Bill Length&quot;</span>,</span>
<span id="cb33-13"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Bill Depth&quot;</span>,</span>
<span id="cb33-14"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb33-15"><a href="code-once-run-twice-creating-your-own-functions.html#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dk</span>()</span></code></pre></div>
<p>Figure <a href="code-once-run-twice-creating-your-own-functions.html#fig:theme-dk-histogram-package">14.5</a> shows the visualization (which is identical to that seen in Figure <a href="code-once-run-twice-creating-your-own-functions.html#fig:theme-dk-histogram">14.1</a>) that this code produces.</p>
<div class="figure"><span style="display:block;" id="fig:theme-dk-histogram-package"></span>
<img src="packages_files/figure-html/theme-dk-histogram-package-1.png" alt="A histogram made with the `theme_dk()` function from the `dk` package" width="100%" />
<p class="caption">
Figure 14.5: A histogram made with the <code>theme_dk()</code> function from the <code>dk</code> package
</p>
</div>
<p>The histogram may be identical, but the process was not. While I had to manually define and run the code to create <code>theme_dk()</code> in Chapter <a href="#functions-chapter"><strong>??</strong></a>, here I only have to run <code>library(dk)</code> and I have access to the <code>theme_dk()</code> function. And the great thing is that, if I were to make changes to <code>theme_dk()</code>, users can simply reinstall the <code>dk</code> package to get access to the most up-to-date functions.</p>
</div>
</div>
<div id="in-conclusion-youre-already-ready-to-make-your-own-r-package" class="section level2 unnumbered">
<h2>In Conclusion: You’re Already Ready to Make Your Own R Package</h2>
<p>In my conversation with Travis Gerke and Garrick Aden-Buie of the Moffitt Cancer Center I had a realization: the name <em>package</em> refers to packaging up of several things that allow you and others to reliably run your code. A package is a set of functions, instructions to automatically install of dependency packages, and code documentation. If you write code that you share with others through a <code>functions.R</code> file, it may or may not work on their computer. They may not have the necessary packages installed. They may be confused about how arguments work and not know where to go. If you put your functions in a package, they are close to guaranteed to work. And users will have built-in documentation to help them use the functions on their own.</p>
<p>Creating your own R package may seem scary, but it’s not as complicated as you might think. In 2021, experienced package developer and educator Malcolm Barrett gave a talk titled “You’re Already Ready: Zen and the Art of R Package Development.” The abstract for the talk resonated deeply with me:</p>
<blockquote>
<p>Many believe package development is too advanced for them or that they have nothing to offer. A fundamental belief in Zen is that you are already complete, that you already have everything you need. I’ll talk about why your project is already an R package, why you’re already an R package developer, and why you already have the skills to walk the path of development.</p>
</blockquote>
<p>I hope, after reading this chapter, this message resonates with you as well.</p>
<p>Making packages can help you as an individual. Creating a ggplot theme like I did in this chapter, for example, can allow you to easily use it on any data visualization you make. Packages can be especially beneficial for organizations. This is exactly what Travis Gerke and Garrick Aden-Buie found during their time at the Moffitt Cancer Center. Accessing databases was so complicated that many people got stuck at that point. But when Gerke and Aden-Buie provided them with a package that contained functions to easily access the databases, Moffitt researchers began to do more with R. Gerke described the transformation: “People got to actually write code and do the data queries instead of handling administrative silliness.” Developing packages can allow more advanced users to help those with less experience using R. Aden-Buie told me that packages create “a number of gradual on-ramps for people who are getting more skills in coding.” Because more people are able to use these on-ramps, they come to see the value of using code.</p>
<p>What’s more, developing packages allows you as the package developer to shape how others work. Say you make a ggplot theme that follows the principles of high-quality data visualization (see Chapter <a href="data-viz-chapter.html#data-viz-chapter">4</a>). If you put this theme in a package, you can give others an easy way to follow these principles. Garrick Aden-Buie calls this a “happy path.” If you create a package, you can guide people on the happy path that you think is best. Packages are a way to ensure that others use best practices without them even being aware they are doing so.</p>
<p>Making your own R package is not as hard as you might think and comes with many benefits. Packages make it easy to reuse code across projects, allow you to help others, and encourage best practices. If you haven’t ever made your own R package, now’s the time to give it a try.</p>

</div>
</div>



</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R Without Statistics</strong>" was written by David Keyes. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


</body>

</html>
